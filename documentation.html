<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    
  <head>
    <link href="stylesheets/themes/smoothness/ui.all.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="javascripts/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="javascripts/jquery-ui-1.7.custom.min.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function(){
        jQuery("#tabs-top").tabs();
        jQuery(".taglib").tabs();
        jQuery(".source").accordion({collapsible: true, active: false, autoHeight: false });
      });
    </script>
  </head>
  <body>
    <div id="tabs-top">
      <ul>
        
          
  <li>
    <a href="#hobo-jquery-taglib">
      <span>
        hobo-jquery
      </span>
    </a>
  </li>

        
      </ul>
      <!-- unfortunately, <repeat> is problematic here -->
      
        <div class="taglib" id="hobo-jquery-taglib">
          <p>This is the jQuery plugin for Hobo. This plugin provides the jQuery UI widgets in a Hobo friendly manner, provides useful tags and functions for jQuery javascript coding, and provides additional composite tags.</p>

<p>To use, see the <a href='README.html'>installation instructions</a></p>

<p>The jQuery UI tags support all of the <a href='http://docs.jquery.com/UI'>options that the corresponding jQuery UI widgets provide</a>. For example:</p>

<pre><code>&lt;hjq-datepicker dateFormat=&quot;yy-mm-dd&quot; /&gt;</code></pre>

<p>Options that expect a type other than string can be provided by passing a ruby object:</p>

<pre><code>&lt;hjq-datepicker dayNamesMin=&quot;&[&#39;Di&#39;, &#39;Lu&#39;, &#39;Ma&#39;, &#39;Me&#39;, &#39;Je&#39;, &#39;Ve&#39;, &#39;Sa&#39;]&quot; /&gt;</code></pre>

<p>Events are also supported. Pass in a global Javascript function name:</p>

<pre><code>&lt;hjq-datepicker onSelect=&quot;hjq.log&quot; /&gt;</code></pre>
          <ul>
            
              
  <li>
    <a href="#annotate-tag-tag">
      <span>
        annotate-tag
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-assets-tag">
      <span>
        hjq-assets
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#jquery-assets-tag">
      <span>
        jquery-assets
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hobo-jquery-assets-tag">
      <span>
        hobo-jquery-assets
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-datepicker-tag">
      <span>
        hjq-datepicker
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-input-many-tag">
      <span>
        hjq-input-many
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-input-many-item-tag">
      <span>
        hjq-input-many-item
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#formlet-tag">
      <span>
        formlet
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#formlet-submit-tag">
      <span>
        formlet-submit
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-dialog-tag">
      <span>
        hjq-dialog
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-dialog-open-button-tag">
      <span>
        hjq-dialog-open-button
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#hjq-dialog-and-button-tag">
      <span>
        hjq-dialog-and-button
      </span>
    </a>
  </li>

            
              
  <li>
    <a href="#select-one-or-new-dialog-tag">
      <span>
        select-one-or-new-dialog
      </span>
    </a>
  </li>

            
          </ul>
          
            <div id="annotate-tag-tag">
          
              <h2>annotate-tag</h2>
              
              <p>This is Hobo jQuery&#8217;s standard tag annotation method. This annotation is automatically added to Hobo jQuery tags, but you may wish to use it in your own tag definitions.</p>

<p>The current implementation uses HTML comments for annotation. This may change in the future, if somebody can suggest a better mechanism. <a href='http://www.1729.com/blog/HtmlAnnotations.html'>Here is a good discussion of the alternatives.</a>. Two more possibilities are http://www.w3.org/TR/xhtml-rdfa-primer and http://ejohn.org/blog/html-5-data-attributes/.</p>

<p>To use it, invoke this tag directly before the tag to annotate. To get the annotations, call hjq.getAnnotations with <em>this</em> set to the element that has been annotated. For example:</p>

<pre><code>&lt;def tag=&quot;mytag&quot;&gt;
  &lt;annotate-tag option_a=&quot;42&quot;/&gt;
  &lt;div class=&quot;hjq-annotated&quot;&gt;
    ...
  &lt;/div&gt;
&lt;/def&gt;

jQuery(this).find(&#39;.hjq-annotated&#39;).each(function() {
  var annotations = hjq.getAnnotations.call(this);
  ...
});</code></pre>
          
              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def tag='annotate-tag'&gt;
  &lt;%= &quot;&lt;!-- json_annotation (#{attributes.to_json}); --&gt;&quot; %&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-assets-tag">
          
              <h2>hjq-assets</h2>
              
              <p>These are the Hobo jQuery and jQuery assets required by Hobo jQuery. You will probably wish to add this to your page definition:</p>

<pre><code>&lt;extend tag=&quot;page&quot;&gt;
  &lt;old-page merge&gt;
    &lt;custom-scripts:&gt;
      &lt;hjq-assets/&gt;
    &lt;/custom-scripts&gt;
  &lt;/old-page&gt;
&lt;/extend&gt;</code></pre>
          
              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def tag='hjq-assets'&gt;
  &lt;jquery-assets/&gt;
  &lt;hobo-jquery-assets/&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="jquery-assets-tag">
          
              <h2>jquery-assets</h2>
              
              
          
              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def tag='jquery-assets'&gt;
  &lt;stylesheet name='smoothness/jquery-ui-1.7.custom.css'/&gt;
  &lt;javascript name='jquery-1.3.2.min.js'/&gt;
  &lt;javascript name='jquery-ui-1.7.custom.min.js'/&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hobo-jquery-assets-tag">
          
              <h2>hobo-jquery-assets</h2>
              
              
          
              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def tag='hobo-jquery-assets'&gt;
  &lt;stylesheet name='hobo-jquery.css'/&gt;
  &lt;javascript name='hobo-jquery.js'/&gt;
  &lt;script type='text/javascript'&gt;
    jQuery.noConflict();
    jQuery(document).ready(function() {
      hjq.initialize.call(document);
    });
  &lt;/script&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-datepicker-tag">
          
              <h2>hjq-datepicker</h2>
              
              <p>This is the <a href='http://docs.jquery.com/UI/Datepicker'>jQuery-UI datepicker</a>. All options and events are supported.</p>

<p>It&#8217;s probably easiest to add this to your application.dryml:</p>

<pre><code>&lt;def tag=&quot;input&quot; for=&quot;Date&quot;&gt;
  &lt;hjq-datepicker dateFormat=&quot;yy-mm-dd&quot; merge /&gt;
&lt;/def&gt;</code></pre>

<p>It&#8217;s probably useful to set global options such as dateFormat in application.dryml and set local options such as yearRange in the tag invocation:</p>

<pre><code>&lt;input:birthdate yearRange=&quot;1900:#{Date.today.year}&quot; /&gt;</code></pre>
          
              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def attrs='name' tag='hjq-datepicker'&gt;
&lt;%
  options, attrs = attributes.partition_hash(['altField', 'altFormat', 'appendText', 'buttonImage', 'buttonImageOnly', 'buttonText', 'changeMonth', 'changeYear', 'closeText', 'constrainInput', 'currentText', 'dateFormat', 'dayNames', 'dayNamesMin', 'dayNamesShort', 'defaultDate', 'duration', 'firstDay', 'gotoCurrent', 'hideIfNoPrevNext', 'isRTL', 'maxDate', 'minDate', 'monthNames', 'monthNamesShort', 'navigationAsDateFormat', 'nextText', 'numberOfMonths', 'prevText', 'shortYearCutoff', 'showAnim', 'showButtonPanel', 'showCurrentAtPos', 'showMonthAfterYear', 'showOn', 'showOptions', 'showOtherMonths', 'stepMonths', 'yearRange'])
  events, html_attrs = attrs.partition_hash(['beforeShow', 'beforeShowDay', 'onChangeMonthYear', 'onClose', 'onSelect'])
%&gt;
 &lt;annotate-tag tag='hjq-datepicker' events='&amp;events' init='hjq.datepicker.init' options='&amp;options'/&gt;
 &lt;% html_attrs = add_classes(html_attrs, &quot;hjq-annotated&quot;); %&gt;
 &lt;%= text_field_tag(name, this, html_attrs) %&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-input-many-tag">
          
              <h2>hjq-input-many</h2>
              
              <p>Creates a sub-section of the form which the user can repeat using (+) and (-) buttons, in order to allow an entire <code>has_many</code> collection to be created/edited in a single form.</p>

<p>This tag is similar to the standard Hobo <code>&lt;input-many&gt;</code> tag, but it includes several additional features.</p>

<ul>
<li>it supports 0 length associations</li>

<li>it supports delayed initialization, required for some Javascript elements like the jQuery UI datepicker</li>

<li>it allows the (+) and (-) buttons to be customized</li>

<li>it provides a default for the <code>item</code> parameter</li>

<li>it copies from a template rather than cloning the current item and clearing it</li>

<li>the template may be overridden</li>

<li>javascript hooks for (+) and (-)</li>
</ul>

<p>It also fixes the following buglets in input-many:</p>

<ul>
<li>id&#8217;s of textareas and selects and other non-input&#8217;s are adjusted properly</li>

<li>classdata for inner elements updated</li>

<li>the original input-many didn&#8217;t clear textareas and select&#8217;s. We don&#8217;t have a clear -&gt; no buglet! :)</li>
</ul>

<p>Because this implementation contains more than one parameter, the default parameter from input-many has been renamed to <code>item</code>.</p>
          
              
                <h3>Parameters</h3>
                
  <ul>
    
      <li>item
        
  

      </li>
    
      <li>remove-item
        
  

      </li>
    
      <li>add-item
        
  

      </li>
    
      <li>empty-message
        
  

      </li>
    
      <li>remove-item
        
  

      </li>
    
      <li>add-item
        
  

      </li>
    
      <li>item
        
  

      </li>
    
      <li>remove-item
        
  

      </li>
    
      <li>add-item
        
  

      </li>
    
      <li>item
        
  

      </li>
    
      <li>remove-item
        
  

      </li>
    
      <li>add-item
        
  

      </li>
    
  </ul>

              
          
              <h3 id='example'>Example</h3>

<p>Say you are creating a new <code>Category</code> in your online shop, and you want to create some initial products <em>in the same form</em>, you can add the following to your form:</p>

<pre><code>&lt;hjq-input-many:products fields=&quot;name, price&quot; /&gt;</code></pre>

<p>You&#8217;ll often want to provide the <code>item</code> parameter:</p>

<pre><code>&lt;hjq-input-many:products&gt;&lt;item:&gt;&lt;field-list fields=&quot;name, price&quot; /&gt;&lt;/item:&gt;&lt;/hjq-input-many&gt;</code></pre>

<p>A fully worked up example of nested hjq-input-many&#8217;s may be found in <a href='http://github.com/tablatom/agility/blob/jquery-test/app/views/projects/nested_has_many_test.dryml'>agility/jquery-test</a></p>

<h3 id='attributes'>Attributes</h3>

<ul>
<li>
<p>minimum: the minimum number of items in the collection. Currently only &#8216;0&#8217; and &#8216;1&#8217; are supported values. The default is &#8216;0&#8217;.</p>
</li>

<li>
<p>fields: passed down to the <code>field-list</code> tag in the default <code>item</code>.</p>
</li>

<li>
<p>template: the default values for new items. Normally this functionality is better provided by Model.new, but it&#8217;s here if you need it.</p>
</li>

<li>
<p>add-hook: a javascript function to call after an item has been added. The context will be set to the new item.</p>
</li>

<li>
<p>remove-hook: a javascript function to call before an item is removed. The context will be set to the item. If the hook returns false, the remove is cancelled.</p>
</li>
</ul>

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def attrs='minimum, fields, new-template, remove-hook' polymorphic tag='hjq-input-many'&gt;
&lt;%
# helper function to create id's on buttons to facilitate testing
def underize(s)
  s.gsub(/\[/,&quot;_&quot;).gsub(/\]/,&quot;&quot;)
end
%&gt;
  &lt;set empty='&amp;this.empty?'/&gt;
  &lt;annotate-tag tag='hjq-input-many' merge-attrs='minimum, add-hook, remove-hook' init='hjq.input_many.init'/&gt;
  &lt;ul class='hjq-input-many #{this_field.dasherize} #{css_data :input_many_prefix, param_name_for_this} hjq-annotated'&gt;
    &lt;% template ||= this.try.new_candidate || this.member_class.new %&gt;
    &lt;% minimum ||= 0 ; minimum = minimum.to_i %&gt;
    &lt;fake-field-context fake-field='-1' context='&amp;template'&gt;
      &lt;li class='input-many-template' id='#{param_name_for_this}'&gt;
        &lt;hjq-input-many-item param='item' merge-attrs='fields'/&gt;
        &lt;div class='buttons'&gt;
          &lt;button param='remove-item' id='#{underize param_name_for_this}_remove'&gt;-&lt;/button&gt;
          &lt;button param='add-item' id='#{underize param_name_for_this}_add'&gt;+&lt;/button&gt;
        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/fake-field-context&gt;
    &lt;li class='empty #{&amp;apos;hidden&amp;apos; unless this.empty? and minimum==0}' id='#{param_name_for_this}[-1]_empty'&gt;
      &lt;!-- HACK way to signal an empty collection to the controller --&gt;
      &lt;input name='#{param_name_for_this}' class='empty-input' id='#{param_name_for_this}' type='hidden' value='' disabled='&amp;(!this.empty? || minimum&gt;0)'/&gt;
      &lt;fake-field-context fake-field='-1' context='&amp;template'&gt;
        &lt;div param='empty-message'&gt;
          No &lt;%= this.class.class_name.humanize.downcase.pluralize %&gt;.
        &lt;/div&gt;
        &lt;div class='buttons'&gt;
          &lt;button class='hidden' param='remove-item' id='#{underize param_name_for_this}_remove'&gt;-&lt;/button&gt;
          &lt;button param='add-item' id='#{underize param_name_for_this}_add'&gt;+&lt;/button&gt;
        &lt;/div&gt;
      &lt;/fake-field-context&gt;      
    &lt;/li&gt;
    &lt;fake-field-context fake-field='0' context='&amp;template'&gt;
      &lt;li id='#{param_name_for_this}' if='&amp;(this_parent.empty? &amp;&amp; minimum&gt;0)'&gt;
        &lt;hjq-input-many-item param='item' merge-attrs='fields'/&gt;
        &lt;div class='buttons'&gt;
          &lt;button class='hidden' param='remove-item' id='#{underize param_name_for_this}_remove'&gt;-&lt;/button&gt;
          &lt;button param='add-item' id='#{underize param_name_for_this}_add'&gt;+&lt;/button&gt;
        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/fake-field-context&gt;       
    &lt;li class='#{&amp;apos;record-with-errors&amp;apos; unless this.errors.empty?}' repeat id='#{param_name_for_this}'&gt;
      &lt;error-messages class='sub-record' without-heading/&gt;
      &lt;hidden-id-field/&gt;
      &lt;hjq-input-many-item param='item' merge-attrs='fields'/&gt;
      &lt;div class='buttons'&gt;
        &lt;button class='#{&amp;apos;hidden&amp;apos; if this_parent.length&lt;=minimum}' param='remove-item' id='#{underize param_name_for_this}_remove'&gt;-&lt;/button&gt;
        &lt;button class='#{&amp;apos;hidden&amp;apos; if not last_item?}' param='add-item' id='#{underize param_name_for_this}_add'&gt;+&lt;/button&gt;
      &lt;/div&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-input-many-item-tag">
          
              <h2>hjq-input-many-item</h2>
              
              <p>This is the default item used by <code>&lt;hjq-input-many&gt;</code>. Redefine or extend if desired.</p>
          
              
                <h3>Parameters</h3>
                
  <ul>
    
      <li>default
        
  

      </li>
    
  </ul>

              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def attrs='fields' tag='hjq-input-many-item'&gt;
  &lt;card param='default'&gt;
    &lt;header: replace/&gt;
    &lt;body:&gt;&lt;field-list merge-attrs='fields'/&gt;&lt;/body:&gt;
  &lt;/card&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="formlet-tag">
          
              <h2>formlet</h2>
              
              <p><code>&lt;formlet&gt;</code> works like an AJAX <code>&lt;form&gt;</code> without actually being an AJAX <code>&lt;form&gt;</code>. This is usefully in scenarios where forms aren&#8217;t allowed or are problematic, like inside of another form.</p>
          
              
          
              <h3 id='attributes'>Attributes</h3>

<ul>
<li>
<p>standard Hobo HTML attributes (id, part, et cetera). All supported.</p>
</li>

<li>
<p>standard Hobo AJAX attributes: (see http://cookbook.hobocentral.net/api<em>taglibs/rapid</em>forms)</p>

<ul>
<li>
<p>update: (optional). The DOM ID&#8217;s of parts to update. Note that you get an AJAX formlet whether this is provided or not.</p>
</li>

<li>
<p>message: the spinner message</p>
</li>

<li>
<p>spinner<em>next</em>to: DOM id of an element to position the ajax progress spinner next to.</p>
</li>

<li>
<p>before, success, error, complete: These callbacks are slightly different from the standard form callbacks. They are called with &#8220;this&#8221; set to the formlet. Also, you may pass in a function name rather than a javascript fragment. If the before callback returns false, it will cancel the submission.</p>
</li>

<li>
<p>confirm: a message to be displayed in a JavaScript confirm dialog. By default there is no confirm dialog</p>
</li>

<li>
<p>not supported: type, script, form, params, confirm, reset-form, refocus-form, result-update. None of these are particularly hard to support. Email or post a message to the list if you need them.</p>
</li>
</ul>
</li>

<li>
<p>standard Hobo Form attributes (all supported):</p>

<ul>
<li>
<p>hidden-fields</p>
</li>

<li>
<p>action</p>
</li>

<li>
<p>method</p>
</li>

<li>
<p>web-method</p>
</li>

<li>
<p>lifecycle</p>
</li>

<li>
<p>owner</p>
</li>
</ul>
</li>
</ul>

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def polymorphic attrs='update, hidden-fields, action, method, web-method, lifecycle, owner' tag='formlet'&gt;
&lt;%
#FIXME: code very similar to &lt;form&gt;.  refactor out common code.

  ajax_attrs, html_attrs = attributes.partition_hash(Hobo::RapidHelper::AJAX_ATTRS)

  ajax_options = {}

  new_record = this.try.new_record?

  method = if method.nil?
             (action || web_method || new_record) ? &quot;post&quot; : &quot;put&quot;
           else
             method.downcase
           end

  ajax_options[:url] = action || begin
     target = if owner
                collection_name = this.class.reverse_reflection(owner).name
                this.send(owner).send(collection_name)
              else
                this
              end
     action = web_method || lifecycle
     object_url(target, action, :method =&gt; &quot;post&quot;)
  end

  if action.nil? &amp;&amp; (ajax_options[:url].nil? ||
                     (lifecycle.nil? &amp;&amp; new_record &amp;&amp; !this.creatable_by?(current_user)) ||
                     (lifecycle.nil? &amp;&amp; !new_record &amp;&amp; !can_edit?))
    Hobo::Dryml.last_if = false
    logger.info(&quot;blank!!!&quot;)
    &quot;&quot;
  else
    if method == &quot;put&quot;
      # browsers don't support put -- use post and add the Rails _method hack
      http_method_hidden = hidden_field_tag(&quot;_method&quot;, &quot;PUT&quot;) 
      ajax_options[:type] = &quot;post&quot;
    else
      ajax_options[:type] = method
    end

    ajax_attrs[:update] = if update 
                            update.split(/,\s*/) 
                          else
                            []
                          end

    hiddens = nil
    body = with_form_context do
      # It is important to evaluate parameters.default first, in order to populate scope.form_field_names
      b = parameters.default
      hiddens = self.hidden_fields(:fields =&gt; hidden_fields) if new_record
      b
    end

    auth_token = if method.nil? || method == 'get' || !protect_against_forgery?
                   ''
                 else
                   element(:input, {:type =&gt; &quot;hidden&quot;, 
                           :name =&gt; request_forgery_protection_token.to_s,
                           :value =&gt; form_authenticity_token}, nil, true, true)
                 end
     
    unless method == &quot;get&quot;
      page_path = if (request.post? || request.put?) &amp;&amp; params[:page_path]
                    params[:page_path]
                  else
                    view_name.sub(Hobo::Dryml::EMPTY_PAGE, params[:action])
                  end
      page_path_hidden = hidden_field_tag(&quot;page_path&quot;, page_path) 
    end

    hiddens_div = element(:div, {:class =&gt; &quot;hidden-fields&quot;}, [http_method_hidden, page_path_hidden, auth_token, hiddens].join)
     
    body = [hiddens_div, body].join

    if action.nil? # don't add automatic css classes if the action was specified
      if web_method
        add_classes!(html_attrs, &quot;#{type_id.dasherize}-#{web_method}-form&quot;)
      else
        add_classes!(html_attrs, &quot;#{'new ' if new_record}#{type_id.dasherize}&quot;)
      end
    end

    Hobo::Dryml.last_if = true
  end

  add_classes!(html_attrs, &quot;formlet&quot;)
%&gt;
&lt;annotate-tag ajax-attrs='&amp;ajax_attrs' tag='formlet' ajax-options='&amp;ajax_options'/&gt;
  &lt;%= element(&quot;div&quot;, html_attrs, body) %&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="formlet-submit-tag">
          
              <h2>formlet-submit</h2>
              
              <p>Submit button for use with <code>&lt;formlet&gt;</code>. Submit won&#8217;t work, because <code>&lt;formlet&gt;</code> isn&#8217;t a form.</p>
          
              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def attrs='label, image, method' tag='formlet-submit'&gt;
  &lt;% label ||= 'submit' %&gt;
  &lt;if test='&amp;image'&gt;
    &lt;input class='image-button formlet-submit-button' src='&amp;image' merge-attrs type='image'/&gt;
  &lt;/if&gt;
  &lt;else&gt;
    &lt;input class='button formlet-submit-button' onClick='hjq.formlet.submit.call(this)' merge-attrs type='button' value='#{label}'/&gt;
  &lt;/else&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-dialog-tag">
          
              <h2>hjq-dialog</h2>
              
              <p>The JQuery UI <a href='http://jqueryui.com/demos/dialog/'>dialog</a>. All options and methods are supported.</p>

<p>The default for <a href='http://jqueryui.com/demos/dialog/#option-autoOpen'>autoOpen</a> has been changed to &#8220;&false&#8221;. To display the dialog set autoOpen to &#8220;&true&#8221;, use a <code>&lt;hjq-dialog-open-button&gt;</code>, use the <a href='http://jqueryui.com/demos/dialog/#method-open'>jQuery dialog open method</a>, or use an <code>&lt;hjq-dialog-and-button&gt;</code> instead.</p>

<p>The default for <a href='http://jqueryui.com/demos/dialog/#option-position'>positon</a> is also set so that the dialog appears where it is defined.</p>

<p>The <a href='http://jqueryui.com/demos/dialog/#option-buttons'>positon</a> has been changed slightly. Instead of an Hash, it expects a list of pairs. (Unlike Javascript Objects, Ruby Hash&#8217;s do not preserve order). Because of quoting issues, it&#8217;s usually easier to assign the list to a variable and then include the list:</p>

<pre><code>&lt;% buttons = [ [&quot;cancel&quot;, &quot;jQuery(this).dialog(&#39;close&#39;)&quot;] ] %&gt;
&lt;hjq-dialog buttons=&quot;&buttons&quot; /&gt;</code></pre>

<p>or</p>

<pre><code>&lt;hjq-dialog id=&quot;story-dialog&quot; buttons=&#39;&{&quot;cancel&quot; =&gt; &quot;jQuery(this).dialog(\&quot;close\&quot;)&quot;}&#39; /&gt;</code></pre>

<p>or</p>

<pre><code>&lt;hjq-dialog id=&quot;story-dialog&quot; buttons=&#39;&{&quot;cancel&quot; =&gt; &quot;hjq.dialog.close&quot;}&#39; /&gt;</code></pre>

<p>Because Ruby Hash&#8217;s do not preserve order, you may use a list of pairs instead of a Hash.</p>

<p>The following functions are predefined for use in dialog buttons:</p>

<ul>
<li>hjq.dialog.close: close the dialog box</li>

<li>hjq.dialog.submit<em>formlet: submits all formlets inside the dialog</em></li>

<li>hjq.dialog.submit<em>formlet</em>and<em>close: Submits any enclosed formlets, then closes the dialog. Warning: hijacks the &#8220;success&#8221; formlet option. <em>/</em></em></li>
</ul>
          
              
                <h3>Parameters</h3>
                
  <ul>
    
      <li>default
        
  

      </li>
    
  </ul>

              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def attrs='buttons' tag='hjq-dialog'&gt;
&lt;% #FIXME: dry these names
 options, attrs = attributes.partition_hash([&quot;autoOpen&quot;, &quot;bgiframe&quot;, &quot;closeOnEscape&quot;, &quot;dialogClass&quot;, &quot;draggable&quot;, &quot;height&quot;, &quot;hide&quot;, &quot;maxHeight&quot;, &quot;maxWidth&quot;, &quot;minWidth&quot;, &quot;modal&quot;, &quot;position&quot;, &quot;resizable&quot;, &quot;show&quot;, &quot;stack&quot;, &quot;title&quot;, &quot;width&quot;, &quot;zIndex&quot;])
 events, html_attrs = attrs.partition_hash([&quot;beforeclose&quot;, &quot;open&quot;, &quot;focus&quot;, &quot;dragStart&quot;, &quot;drag&quot;, &quot;dragStop&quot;, &quot;resizeStart&quot;, &quot;resize&quot;, &quot;resizeStop&quot;, &quot;close&quot;])
 options[&quot;autoOpen&quot;]=false unless options.has_key?(&quot;autoOpen&quot;)
%&gt;
 &lt;span class='hjq-dialog-position'/&gt;
 &lt;annotate-tag buttons='&amp;buttons' tag='hjq-dialog' events='&amp;events' init='hjq.dialog.init' options='&amp;options'/&gt;
 &lt;% html_attrs = add_classes(html_attrs, &quot;hjq-annotated hidden&quot;); %&gt;
 &lt;div merge-attrs='&amp;html_attrs' param='default'/&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-dialog-open-button-tag">
          
              <h2>hjq-dialog-open-button</h2>
              
              <p>When pressed, will open a <code>&lt;hjq-dialog&gt;</code>.</p>
          
              
                <h3>Parameters</h3>
                
  <ul>
    
      <li>default
        
  

      </li>
    
  </ul>

              
          
              <h3 id='attributes'>Attributes</h3>

<ul>
<li>dialog (required):a CSS selector (AKA jQuery selector) to locate the dialog in the DOM. Remember, if you&#8217;re passing an ID, place a &#8217;#&#8217; in front of the ID.</li>

<li>all <code>&lt;button&gt;</code> attributes except for onclick</li>
</ul>

<h3 id='example'>Example</h3>

<pre><code>&lt;hjq-dialog id=&quot;hello-dialog&quot;&gt;Hello!&lt;/hjq-dialog&gt;
&lt;hjq-dialog-open-button dialog=&quot;#hello-dialog&quot;&gt;Press Me!&lt;/hjq-dialog-open-button&gt;</code></pre>

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def attrs='dialog' tag='hjq-dialog-open-button'&gt;
  &lt;button merge class='hjq-dialog-open-button' param='default' onclick='hjq.dialog_opener.click(this, jQuery(&amp;apos;#{dialog}&amp;apos;)); return false;'/&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="hjq-dialog-and-button-tag">
          
              <h2>hjq-dialog-and-button</h2>
              
              <p>Defines an <code>&lt;hjq-dialog&gt;</code> and a <code>&lt;hjq-dialog-open-button&gt;</code> and links the two together.</p>
          
              
                <h3>Parameters</h3>
                
  <ul>
    
      <li>hjq-dialog
        
  

      </li>
    
      <li>hjq-dialog-open-button
        
  

      </li>
    
  </ul>

              
          
              <h3 id='attributes'>Attributes</h3>

<ul>
<li>id (optional): the DOM id to use for the dialog</li>
</ul>

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def tag='hjq-dialog-and-button'&gt;
  &lt;% # we can't use jQuery traversal functions since the dialog will move around in the DOM %&gt;
  &lt;% attributes[&quot;id&quot;]=&quot;hjq-dialog-#{(rand*1000000000).to_i}&quot; unless attributes.has_key?(&quot;id&quot;) %&gt;
  &lt;hjq-dialog merge param/&gt;
  &lt;hjq-dialog-open-button param dialog='##{attributes[&amp;apos;id&amp;apos;]}'/&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
            <div id="select-one-or-new-dialog-tag">
          
              <h2>select-one-or-new-dialog</h2>
              
              <p>Defines a <code>&lt;select-one&gt;</code> and a button that brings up an <code>&lt;hjq-dialog&gt;</code> containing a form allowing you to enter a new element</p>

<p>Because the select-one is a part, it cannot be parameterized. However, you can adjust its definition by overriding the polymorphic input for the type:</p>

<pre><code>&lt;def tag=&quot;input&quot; for=&quot;StoryStatus&quot;&gt;
  &lt;select-one include-none=&quot;&false&quot; /&gt;
&lt;/def&gt;</code></pre>
          
              
                <h3>Parameters</h3>
                
  <ul>
    
      <li>hjq-dialog-open-button
        
  

      </li>
    
      <li>hjq-dialog
        
  

      </li>
    
  </ul>

              
          
              

              <div class="source">
                <h3><a href="#">Source</a></h3>
                <pre><code>&lt;def tag='select-one-or-new-dialog'&gt;
  &lt;% dialog_id=&quot;hjq-dialog-#{typed_id.gsub(':', '-')}&quot; %&gt;
  &lt;% part_id = &quot;select-one-#{typed_id.gsub(':', '-')}&quot; %&gt;
  &lt;input id='&amp;part_id' part='select-one-or-new-dialog-select'/&gt;
  &lt;hjq-dialog-open-button param dialog='##{dialog_id}'&gt;
    New &lt;% this_field.humanize %&gt;
  &lt;/hjq-dialog-open-button&gt;
  &lt;hjq-dialog buttons='&amp;[[&quot;cancel&quot;, &quot;hjq.dialog.close&quot;], [&quot;ok&quot;, &quot;hjq.dialog.submit_formlet_and_close&quot;]]' title='New #{this_field.humanize}' param id='&amp;dialog_id'&gt;
    &lt;formlet success='jQuery(&amp;apos;##{part_id} select&amp;apos;).val(jQuery(&amp;apos;##{part_id} option:last&amp;apos;).val())' update='&amp;part_id' with='&amp;this_type.new'&gt;
      &lt;field-list/&gt;
    &lt;/formlet&gt;
  &lt;/hjq-dialog&gt;
&lt;/def&gt;</code></pre>
              </div>
          
            </div>
          
        </div>
      
    </div>
  </body>

  </html>